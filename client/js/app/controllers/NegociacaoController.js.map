{"version":3,"sources":["../../app-es6/controllers/NegociacaoController.js"],"names":["currentInstance","negociacaoController","ListaNegociacoes","Mensagem","NegociacoesView","MensagemView","NegociacaoService","DateHelper","Bind","Negociacao","NegociacaoController","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_listaNegociacoes","_mensagem","_service","_init","lista","then","negociacoes","forEach","negociacao","adiciona","erro","texto","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","mensagem","_limpaFormulario","importa","apaga","esvazia","textoParaData","value","parseInt","parseFloat","focus"],"mappings":"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","sourcesContent":["import { ListaNegociacoes } from \"../models/ListaNegociacoes.js\";\r\nimport { Mensagem } from \"../models/Mensagem.js\";\r\nimport { NegociacoesView } from \"../views/NegociacoesView.js\";\r\nimport { MensagemView } from \"../views/MensagemView.js\";\r\nimport { NegociacaoService } from \"../services/NegociacaoService.js\";\r\nimport { DateHelper } from \"../helpers/DateHelper.js\";\r\nimport { Bind } from \"../helpers/Bind.js\";\r\nimport { Negociacao } from \"../models/Negociacao.js\";\r\n\r\nclass NegociacaoController {\r\n  constructor() {\r\n    let $ = document.querySelector.bind(document);\r\n    this._inputData = $(\"#data\");\r\n    this._inputQuantidade = $(\"#quantidade\");\r\n    this._inputValor = $(\"#valor\");\r\n\r\n    this._listaNegociacoes = new Bind(\r\n      new ListaNegociacoes(),\r\n      new NegociacoesView($(\"#negociacoesView\")),\r\n      \"adiciona\",\r\n      \"esvazia\"\r\n    );\r\n\r\n    this._mensagem = new Bind(\r\n      new Mensagem(),\r\n      new MensagemView($(\"#mensagemView\")),\r\n      \"texto\"\r\n    );\r\n\r\n    this._service = new NegociacaoService();\r\n\r\n    this._init();\r\n  }\r\n\r\n  _init() {\r\n    this._service\r\n      .lista()\r\n      .then((negociacoes) =>\r\n        negociacoes.forEach((negociacao) =>\r\n          this._listaNegociacoes.adiciona(negociacao)\r\n        )\r\n      )\r\n      .catch((erro) => (this._mensagem.texto = erro));\r\n\r\n    setInterval(() => {\r\n      this.importaNegociacoes();\r\n    }, 3000);\r\n  }\r\n\r\n  adiciona(event) {\r\n    event.preventDefault();\r\n\r\n    let negociacao = this._criaNegociacao();\r\n\r\n    this._service\r\n      .cadastra(negociacao)\r\n      .then((mensagem) => {\r\n        this._listaNegociacoes.adiciona(negociacao);\r\n        this._mensagem.texto = mensagem;\r\n        this._limpaFormulario();\r\n      })\r\n      .catch((erro) => (this._mensagem.texto = erro));\r\n  }\r\n\r\n  importaNegociacoes() {\r\n    this._service\r\n      .importa(this._listaNegociacoes.negociacoes)\r\n      .then((negociacoes) =>\r\n        negociacoes.forEach((negociacao) => {\r\n          this._listaNegociacoes.adiciona(negociacao);\r\n          this._mensagem.texto = \"Negociações importadas com sucesso\";\r\n        })\r\n      )\r\n      .catch((erro) => (this._mensagem.texto = erro));\r\n  }\r\n\r\n  apaga() {\r\n    this._service\r\n      .apaga()\r\n      .then((mensagem) => {\r\n        this._mensagem.texto = mensagem;\r\n        this._listaNegociacoes.esvazia();\r\n      })\r\n      .catch((erro) => (this._mensagem.texto = erro));\r\n  }\r\n\r\n  _criaNegociacao() {\r\n    return new Negociacao(\r\n      DateHelper.textoParaData(this._inputData.value),\r\n      parseInt(this._inputQuantidade.value),\r\n      parseFloat(this._inputValor.value)\r\n    );\r\n  }\r\n\r\n  _limpaFormulario() {\r\n    this._inputData.value = \"\";\r\n    this._inputQuantidade.value = 1;\r\n    this._inputValor.value = 0.0;\r\n    this._inputData.focus();\r\n  }\r\n}\r\n\r\nlet negociacaoController = new NegociacaoController();\r\nexport function currentInstance() {\r\n  return negociacaoController;\r\n}\r\n"],"file":"NegociacaoController.js"}